<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="layout" content="main">
		<title>Manage Agency</title>
		<script type="text/javascript" src="/js/main/controllers/AgencyController.js"></script>
	</head>

<body layout:fragment="content">
	<div ng-controller="AgencyManageCtrl">
		<div ng-controller="TabController as tabCtrl" ng-init="tabCtrl.setTab(1)">
				<header class="main-heading">
					<div class="masthead">
						<div class="masthead-heading">
							<div class="masthead-title">Manage Agency</div>
						</div>
						<div class="tab-container">
							<ul class="tabs">
								<li class="tab" ng-class="{active:tabCtrl.isSet(1)}" ng-click="tabCtrl.setTab(1)"><a>Agency</a></li>
								<li class="tab" ng-class="{active:tabCtrl.isSet(2)}" ng-click="tabCtrl.setTab(2)"><a>Programs</a></li>
								<li class="tab" ng-class="{active:tabCtrl.isSet(3)}" ng-click="tabCtrl.setTab(3)"><a>Users</a></li>
							</ul>
						</div>
					</div>
				</header>
				<div class="main-content">
					<div class="container-fluid p-t-50">
						<div class="panel panel-primary">
							<div class="panel-heading" ng-show="tabCtrl.isSet(1)">
								<div class="panel-title">Manage Agency</div>
							</div>
							<div class="panel-body" ng-show="tabCtrl.isSet(1)">
								<form>
									<div class="form-line">
										<div class="form-group col-md-4">
											<div class="has-feedback">
												<label for="name">Name</label>
												<input class="form-control" id="name" type="text" ng-model="agency.name">
												<span class="form-control-feedback">
													<i class="{{agency.name ? 'fa fa-check text-success' : 'fa fa-times text-danger'}}" aria-hidden="true"></i>
												</span>
											</div>
										</div>
										<div class="form-group col-md-4">
											<div class="has-feedback">
												<label for="name">NPI</label>
												<input class="form-control" id="npi" type="text" ng-model="agency.npi">
												<span class="form-control-feedback">
													<i class="{{agency.npi ? 'fa fa-check text-success' : 'fa fa-times text-danger'}}" aria-hidden="true"></i>
												</span>
											</div>
										</div>
									</div>
									<div class="form-line">
										<div class="form-group col-md-4">
											<label for="contact_name">Contact</label>
											<input class="form-control" class="form-control" id="contact_name" type="text" ng-model="agency.contact">
										</div>
										<div class="form-group col-md-4">
											<label for="contact_phone">Phone</label>
											<phone-input class="form-control" id="contact_phone" ng-model="agency.phone"></phone-input>
										</div>
										<div class="form-group col-md-4">
											<label for="contact_email">Email</label>
											<input class="form-control" class="form-control" id="contact_email" type="email" ng-model="agency.email">
										</div>
									</div>
									<div class="form-line">
										<div class="form-group col-md-12">
											<label for="address">Address</label>
											<input class="form-control" class="form-control" id="address1" type="text" ng-model="agency.address1">
										</div>
										<div class="form-group col-md-12">
											<input class="form-control" class="form-control" id="address2" type="text" ng-model="agency.address2">
										</div>
									</div>
									<div class="form-line">
										<div class="form-group col-md-3">
											<label for="city">City</label>
											<input class="form-control" class="form-control" id="city" type="text" ng-model="agency.city">
										</div>
										<div class="form-group col-md-3">
											<label for="state">State</label>
											<select class="form-control" id="state" ng-model="agency.state">
												<option value="">--Select--</option>
												<option value="AL">Alabama</option>
												<option value="AK">Alaska</option>
												<option value="AZ">Arizona</option>
												<option value="AR">Arkansas</option>
												<option value="CA">California</option>
												<option value="CO">Colorado</option>
												<option value="CT">Connecticut</option>
												<option value="DE">Delaware</option>
												<option value="DC">District Of Columbia</option>
												<option value="FL">Florida</option>
												<option value="GA">Georgia</option>
												<option value="HI">Hawaii</option>
												<option value="ID">Idaho</option>
												<option value="IL">Illinois</option>
												<option value="IN">Indiana</option>
												<option value="IA">Iowa</option>
												<option value="KS">Kansas</option>
												<option value="KY">Kentucky</option>
												<option value="LA">Louisiana</option>
												<option value="ME">Maine</option>
												<option value="MD">Maryland</option>
												<option value="MA">Massachusetts</option>
												<option value="MI">Michigan</option>
												<option value="MN">Minnesota</option>
												<option value="MS">Mississippi</option>
												<option value="MO">Missouri</option>
												<option value="MT">Montana</option>
												<option value="NE">Nebraska</option>
												<option value="NV">Nevada</option>
												<option value="NH">New Hampshire</option>
												<option value="NJ">New Jersey</option>
												<option value="NM">New Mexico</option>
												<option value="NY">New York</option>
												<option value="NC">North Carolina</option>
												<option value="ND">North Dakota</option>
												<option value="OH">Ohio</option>
												<option value="OK">Oklahoma</option>
												<option value="OR">Oregon</option>
												<option value="PA">Pennsylvania</option>
												<option value="RI">Rhode Island</option>
												<option value="SC">South Carolina</option>
												<option value="SD">South Dakota</option>
												<option value="TN">Tennessee</option>
												<option value="TX">Texas</option>
												<option value="UT">Utah</option>
												<option value="VT">Vermont</option>
												<option value="VA">Virginia</option>
												<option value="WA">Washington</option>
												<option value="WV">West Virginia</option>
												<option value="WI">Wisconsin</option>
												<option value="WY">Wyoming</option>
											</select>
										</div>
										<div class="form-group col-md-3">
											<label for="city">County</label>
											<input class="form-control" class="form-control" id="county" type="text" ng-model="agency.county">
										</div>
										<div class="form-group col-md-3">
											<label for="zip">Zip</label>
											<input class="form-control" class="form-control" id="zip" type="text" ng-model="agency.zip">
										</div>
									</div>
								</form>
							</div>
							<div class="panel-heading" ng-show="tabCtrl.isSet(2)">
								<div class="panel-title">
									Programs <button type="button" class="btn pull-right" ng-click="addProgram()"><i class="fa fa-plus-circle" aria-hidden="true"></i> Add Program</button>
								</div>
							</div>
							<table class="table" ng-show="tabCtrl.isSet(2) && (agency.programs.length > 0 || newPrograms.length > 0)">
								<thead>
									<tr>
										<td width="34px"></td>
										<th style="width: 300px;">Name</th>
										<th style="width: 300px;">Silo Id</th>
										<th></th>
									</tr>
								</thead>
								<tbody>
									<tr ng-repeat="program in agency.programs">
										<td>
											<button class="btn btn-danger btn-xs" ng-click="removeProgram($index)" tabindex="-1"><i class="fa fa-times" aria-hidden="true"></i></button>
										</td>
										<td>
											<div class="form-group has-feedback">
												<input class="form-control" id="name" type="text" ng-model="program.name">
												<span class="form-control-feedback">
												<i class="{{program.name ? 'fa fa-check text-success' : 'fa fa-times text-danger'}}" aria-hidden="true"></i>
												</span>
											</div>
										</td>
										<td>
											<div class="form-group has-feedback">
												<input class="form-control" id="silo" type="text" ng-model="program.silo">
												<span class="form-control-feedback">
													<i class="{{program.silo ? 'fa fa-check text-success' : 'fa fa-times text-danger'}}" aria-hidden="true"></i>
												</span>
											</div>
										</td>
										<td>
											<span class="text-danger">{{isMarked(program) ? '(marked for delete)' : (isDirty(program, $index) ? '(unsaved)' : '')}}</span>
										</td>
									</tr>
									<tr ng-repeat="program in newPrograms">
										<td class="form-group">
											<button class="btn btn-danger btn-xs" ng-click="removeProgram($index)" tabindex="-1"><i class="fa fa-times" aria-hidden="true"></i></button>
										</td>
										<td>
											<div class="form-group has-feedback">
												<input class="form-control" id="name" type="text" ng-model="program._name" ng-model-options="{ getterSetter: true }">
												<span class="form-control-feedback">
												<i class="{{program.name ? 'fa fa-check text-success' : 'fa fa-times text-danger'}}" aria-hidden="true"></i>
												</span>
											</div>
										</td>
										<td>
											<div class="form-group has-feedback">
												<input class="form-control" id="silo" type="text" ng-model="program._silo" ng-model-options="{ getterSetter: true }">
												<span class="form-control-feedback">
													<i class="{{program.silo ? 'fa fa-check text-success' : 'fa fa-times text-danger'}}" aria-hidden="true"></i>
												</span>
											</div>
										</td>
										<td>
											<span class="text-danger">(unsaved)</span>
										</td>
									</tr>
								</tbody>
							</table>
							<div class="panel-heading" ng-show="tabCtrl.isSet(3)">
								<div class="panel-title">
									users
								</div>
							</div>
							<div class="panel-body" ng-show="tabCtrl.isSet(3)">
								<dual-list-box
									target="users"
									options="avalibleUsers"
									display-key="'username'"
									target-label="'Assigned'"
									options-label="'Unassigned'"></dual-list-box>
							</div>
							<div class="panel-footer">
								<button class="btn btn-primary" ng-click="save()" ng-disabled="!agency.name || !agency.npi"><i class="fa fa-floppy-o fa-lg" aria-hidden="true"></i> Save</button>
								<a class="text-danger" ng-click="cancel()"> Cancel</a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</body>
</html>